{% extends 'base.html' %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
	<h3>Welcome, {{ request.user.first_name }}</h3>
	{% if request.user.is_staff %}
		<div>
			<a href="{% url 'hr_dashboard' %}" class="btn btn-outline-secondary btn-sm">HR Dashboard</a>
		</div>
	{% endif %}
</div>

<div class="row g-4">
	<div class="col-md-5">
		<div class="card">
			<div class="card-header">Daily Logbook</div>
			<div class="card-body">
				<form method="post" action="{% url 'task_create' %}">
					{% csrf_token %}
					{{ form.as_p }}
					<button type="submit" class="btn btn-primary">Submit</button>
				</form>
			</div>
		</div>
	</div>
	<div class="col-md-7">
		<div class="card">
			<div class="card-header">Your History</div>
			<div class="card-body p-0">
				<div class="table-responsive">
					<table class="table table-striped table-hover mb-0">
						<thead>
							<tr>
								<th>Date</th>
								<th>Task</th>
								<th>Staff</th>
								<th>Status</th>
								<th></th>
							</tr>
						</thead>
						<tbody>
							{% for t in tasks %}
							<tr>
								<td>{{ t.date }}</td>
								<td style="white-space: pre-wrap;">{{ t.task_description }}</td>
								<td>{{ t.staff.name if t.staff }}</td>
								<td>
									<span class="badge {% if t.status == 'Resolved' %}bg-success{% else %}bg-warning text-dark{% endif %}">{{ t.status }}</span>
								</td>
								<td class="text-end">
									<a href="{% url 'task_update_status' t.id %}" class="btn btn-sm btn-outline-primary">Toggle Status</a>
								</td>
							</tr>
							{% empty %}
							<tr><td colspan="5" class="text-center text-muted">No tasks yet.</td></tr>
							{% endfor %}
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
</div>
{% endblock %}


