{% extends 'base.html' %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
	<h3>HR / Supervisor Dashboard</h3>
	<div>
		<a href="{% url 'hr_export_csv' %}?{{ request.GET.urlencode }}" class="btn btn-sm btn-outline-success">Download CSV</a>
	</div>
</div>

<div class="card mb-3">
	<div class="card-header">Filters</div>
	<div class="card-body">
		<form method="get" class="row g-2">
			<div class="col-md-2">{{ form.start_date.label_tag }} {{ form.start_date }}</div>
			<div class="col-md-2">{{ form.end_date.label_tag }} {{ form.end_date }}</div>
			<div class="col-md-2">{{ form.status.label_tag }} {{ form.status }}</div>
			<div class="col-md-2">{{ form.staff_id.label_tag }} {{ form.staff_id }}</div>
			<div class="col-md-3">{{ form.intern_name.label_tag }} {{ form.intern_name }}</div>
			<div class="col-md-1 d-grid"><button class="btn btn-primary" type="submit">Apply</button></div>
		</form>
	</div>
</div>

<div class="card">
	<div class="card-header">All Intern Activities</div>
	<div class="card-body p-0">
		<div class="table-responsive">
			<table class="table table-striped table-hover mb-0">
				<thead>
					<tr>
						<th>Date</th>
						<th>Intern</th>
						<th>Department</th>
						<th>Staff</th>
						<th>Staff ID</th>
						<th>Staff Phone</th>
						<th>Status</th>
						<th>Task</th>
						<th>Remarks</th>
					</tr>
				</thead>
				<tbody>
					{% for t in tasks %}
					<tr>
						<td>{{ t.date }}</td>
						<td>{{ t.intern.name }}</td>
						<td>{{ t.intern.department }}</td>
						<td>{% if t.staff_name %}{{ t.staff_name }}{% elif t.staff %}{{ t.staff.name }}{% endif %}</td>
						<td>{{ t.staff_identifier }}</td>
						<td>{{ t.staff_phone }}</td>
						<td>
							<form method="post" action="#" onsubmit="return false;">
								<span class="badge {% if t.status == 'Resolved' %}bg-success{% else %}bg-warning text-dark{% endif %}">{{ t.status }}</span>
							</form>
						</td>
						<td style="white-space: pre-wrap;">{{ t.task_description }}</td>
						<td style="white-space: pre-wrap;">{{ t.remarks }}</td>
					</tr>
					{% empty %}
					<tr><td colspan="7" class="text-center text-muted">No records.</td></tr>
					{% endfor %}
				</tbody>
			</table>
		</div>
	</div>
</div>
{% endblock %}


